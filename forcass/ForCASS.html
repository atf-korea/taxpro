<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ForCASS(전자문서 보안점검)</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
<script type="importmap">
{
  "imports": {
    "react": "https://aistudiocdn.com/react@^19.2.0",
    "react-dom/client": "https://aistudiocdn.com/react-dom@^19.2.0/client",
    "react-dom/": "https://aistudiocdn.com/react-dom@^19.2.0/"
  }
}
</script>
<style>
    body {
        font-family: 'Inter', sans-serif;
        background-color: #111827;
        color: #e5e7eb;
    }
    .fade-in {
        animation: fadeIn 1s ease-in-out;
    }
    @keyframes fadeIn {
        from { opacity: 0; transform: translateY(10px); }
        to { opacity: 1; transform: translateY(0); }
    }
    .btn {
        @apply inline-flex items-center justify-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-gray-800 transition-colors duration-200;
    }
</style>
</head>
<body>
    <div id="root"></div>
    <script type="module">
        import React, { useState, useMemo } from 'react';
        import ReactDOM from 'react-dom/client';

        // Icon components
        const XIcon = ({ className }) => (
            React.createElement('svg', { xmlns: "http://www.w3.org/2000/svg", className, fill: "none", viewBox: "0 0 24 24", stroke: "currentColor" },
                React.createElement('path', { strokeLinecap: "round", strokeLinejoin: "round", strokeWidth: 2, d: "M6 18L18 6M6 6l12 12" })
            )
        );

        const ChevronDownIcon = ({ className }) => (
            React.createElement('svg', { xmlns: "http://www.w3.org/2000/svg", className, fill: "none", viewBox: "0 0 24 24", stroke: "currentColor" },
                React.createElement('path', { strokeLinecap: "round", strokeLinejoin: "round", strokeWidth: 2, d: "M19 9l-7 7-7-7" })
            )
        );

        const ArrowRightIcon = ({ className }) => (
            React.createElement('svg', { xmlns: "http://www.w3.org/2000/svg", className, fill: "none", viewBox: "0 0 24 24", stroke: "currentColor" },
                React.createElement('path', { strokeLinecap: "round", strokeLinejoin: "round", strokeWidth: 2, d: "M14 5l7 7m0 0l-7 7m7-7H3" })
            )
        );

        const ArrowDownIcon = ({ className }) => (
             React.createElement('svg', { xmlns: "http://www.w3.org/2000/svg", className, fill: "none", viewBox: "0 0 24 24", stroke: "currentColor" },
                React.createElement('path', { strokeLinecap: "round", strokeLinejoin: "round", strokeWidth: 2, d: "M19 14l-7 7m0 0l-7-7m7 7V3" })
            )
        );

        const DownloadIcon = ({ className }) => (
            React.createElement('svg', { xmlns: "http://www.w3.org/2000/svg", className, fill: "none", viewBox: "0 0 24 24", stroke: "currentColor", strokeWidth: 2 },
              React.createElement('path', { strokeLinecap: "round", strokeLinejoin: "round", d: "M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4" })
            )
        );

        const PRESET_EXTENSIONS = [
            '7z', 'accd', 'asd', 'csv', 'db', 'dbf', 'dbs', 'dbx', 'doc', 'docx', 'dzi',
            'dzw', 'edb', 'eml', 'gul', 'hst', 'hwp', 'lnk', 'mdb', 'msg', 'ost', 'pdf',
            'ppt', 'pptx', 'pst', 'tif', 'tiff', 'txt', 'xls', 'xlsb', 'xlsx', 'xlm', 'zip'
        ].sort();

        const sanitizePath = (inputPath) => {
            let path = inputPath.trim().replace(/\//g, '\\');
            if (!path) return '';

            // If it's just a drive letter like "C" or "C:", format it as "C:\"
            if (/^[a-zA-Z]:?$/.test(path)) {
                return path.charAt(0).toUpperCase() + ':\\';
            }

            if (path.startsWith('\\\\')) {
                path = '\\\\' + path.substring(2).replace(/\\+/g, '\\');
            } else {
                path = path.replace(/\\+/g, '\\');
            }

            if (path.length > 3 && path.endsWith('\\')) {
                path = path.slice(0, -1);
            }
            
            return path;
        };

        const App = () => {
            const isExpired = new Date() >= new Date('2026-01-01'); // Expiration date: 2025-12-31

            if (isExpired) {
                return React.createElement("div", {
                    className: "min-h-screen bg-gray-900 text-gray-200 flex items-center justify-center p-4 fade-in"
                },
                    React.createElement("div", {
                        className: "bg-gray-800 p-8 rounded-lg shadow-lg text-center"
                    },
                        React.createElement("h1", {
                            className: "text-3xl font-bold text-red-400"
                        }, "사용기한이 경과하였습니다.")
                    )
                );
            }

            const [noticeAgreed, setNoticeAgreed] = useState(false);
            
            const [sourcePaths, setSourcePaths] = useState([]);
            const [currentSourcePath, setCurrentSourcePath] = useState('');
            const [targetPath, setTargetPath] = useState('');
            
            const [extensions, setExtensions] = useState(PRESET_EXTENSIONS);
            const [currentExtension, setCurrentExtension] = useState('');
            
            const [department, setDepartment] = useState('');
            const [name, setName] = useState('');
            const [position, setPosition] = useState('');

            const [isExtensionsExpanded, setIsExtensionsExpanded] = useState(false);
            const [editingExtension, setEditingExtension] = useState(null);
            const [generatedScript, setGeneratedScript] = useState('');
            const [isModalOpen, setIsModalOpen] = useState(false);
            
            const handleAddSourcePath = () => {
                const newPath = sanitizePath(currentSourcePath);
                if (newPath && !sourcePaths.includes(newPath)) {
                    setSourcePaths(prev => [...prev, newPath]);
                }
                setCurrentSourcePath('');
            };

            const handleRemoveSourcePath = (pathToRemove) => {
                setSourcePaths(prev => prev.filter(path => path !== pathToRemove));
            };

            const handleAddExtension = () => {
                const newExt = currentExtension.trim().toLowerCase().replace('.', '');
                if (newExt && !extensions.includes(newExt)) {
                    setExtensions(prev => [...prev, newExt].sort());
                }
                setCurrentExtension('');
            };

            const handleRemoveExtension = (extToRemove) => {
                setExtensions(prev => prev.filter(ext => ext !== extToRemove));
            };
            
            const handleStartEditing = (ext) => {
                setEditingExtension({ original: ext, current: ext });
            };

            const handleUpdateExtension = () => {
                if (!editingExtension) return;

                const { original, current } = editingExtension;
                const newExt = current.trim().toLowerCase().replace('.', '');

                if (!newExt || (newExt !== original && extensions.includes(newExt))) {
                    setEditingExtension(null);
                    return;
                }

                setExtensions(prev => prev.map(e => e === original ? newExt : e).sort());
                setEditingExtension(null);
            };
            
            const subfolderName = useMemo(() => {
                const trimmedDept = department.trim();
                const trimmedName = name.trim();
                const trimmedPos = position.trim();

                if (!trimmedDept || !trimmedName) return '';

                const nameAndPosition = trimmedPos ? `${trimmedName}_${trimmedPos}` : trimmedName;

                return `${trimmedDept}\\${nameAndPosition}`;
            }, [department, name, position]);
            
            const fullPathDisplay = useMemo(() => {
                if (!targetPath || !subfolderName) return '';
                return [targetPath, subfolderName].join('\\').replace(/\\+/g, '\\') + '\\';
            }, [targetPath, subfolderName]);

            const logPathDisplay = useMemo(() => {
                if (!targetPath || !subfolderName) return '';
                return [targetPath, subfolderName, 'CopyLog.log'].join('\\').replace(/\\+/g, '\\');
            }, [targetPath, subfolderName]);

            const canStart = useMemo(() => {
                return noticeAgreed && sourcePaths.length > 0 && !!targetPath && extensions.length > 0 && subfolderName !== '';
            }, [noticeAgreed, sourcePaths, targetPath, extensions, subfolderName]);

            const handleGenerateScript = () => {
                if (!canStart) {
                    setGeneratedScript('');
                    return;
                }
            
                const options = "/S /DCOPY:T /TEE /R:1 /W:1 /NP /FP /V /TS /NDL /A-:H";
                const excludedDirsList = [
                    "Documents and Settings", 
                    "Application Data", 
                    "Program Files", 
                    "Program Files (x86)",
                    "Windows",
                    "$RECYCLE.BIN",
                    "System Volume Information"
                ];
                const excludedDirs = `/XD ${excludedDirsList.map(d => `"${d}"`).join(' ')}`;
                
                const filePatterns = extensions.map(ext => `*.${ext}`).join(' ');
                
                const baseTargetPath = [targetPath, subfolderName].join('\\').replace(/\\+/g, '\\');
                const finalLogFilePath = [baseTargetPath, 'CopyLog.log'].join('\\').replace(/\\+/g, '\\');
            
                const commands = sourcePaths.map(source => {
                    let sourceIdentifier;
                    if (source.startsWith('\\\\')) {
                        sourceIdentifier = source.substring(2).replace(/[\\:\\s]/g, '_');
                    } else {
                        sourceIdentifier = source.substring(0, 1);
                    }
            
                    const finalTargetPath = [baseTargetPath, sourceIdentifier].join('\\').replace(/\\+/g, '\\');
                    
                    return `Robocopy "${source}" "${finalTargetPath}" ${filePatterns} ${options} ${excludedDirs} /Log+:"${finalLogFilePath}"`;
                }).join('\r\n');
            
                setGeneratedScript(`@echo off\r\nchcp 65001 > nul\r\n${commands}\r\npause\r\n(goto) 2>nul & del "%~f0"`);
            };

            const handleShowScriptModal = () => {
                if (!canStart) return;
                handleGenerateScript();
                setIsModalOpen(true);
            };
            
            const handleDownloadScript = () => {
                if (!generatedScript) return;
                const blob = new Blob([generatedScript], { type: 'text/plain;charset=utf-8' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = 'robocopy_script.bat';
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                URL.revokeObjectURL(url);
            };

            const handleDownloadAndClose = () => {
                handleDownloadScript();
                setIsModalOpen(false);
            };
            
            const mainContent = React.createElement("div", {
                className: "w-full max-w-4xl space-y-8"
            },
                React.createElement("header", {
                    className: "text-center"
                },
                    React.createElement("h1", {
                        className: "text-4xl font-bold text-white"
                    }, "ForCASS(전자문서 보안점검)")
                ),
                React.createElement("div", {
                    className: "bg-gray-800 p-6 rounded-lg shadow-lg space-y-4"
                },
                    React.createElement("h2", {
                        className: "text-xl font-semibold text-white border-b border-gray-700 pb-2"
                    }, "공지사항"),
                    React.createElement("ol", {
                        className: "list-decimal list-inside text-sm text-gray-300 space-y-2"
                    },
                        React.createElement("li", null, "개인별 PC의 전자문서 보관실태 및 보안관련 정책 수립을 위한 자료수집입니다."),
                        React.createElement("li", null, "자료의 범위는 개별 PC의 전자문서 및 PC에 기록된 사용이력이며, 수집된 자료는 정책수립용도로만 이용될 것입니다."),
                        React.createElement("li", null, "수집된 정보는 정책수립 업무가 종료되는 시점에 일괄적으로 삭제 및 파기되며 그 후 보관하지 않습니다."),
                        React.createElement("li", null, "귀하는 이에 대한 동의를 거부할 수 있습니다.")
                    ),
                    React.createElement("div", {
                        className: "flex items-center"
                    },
                        React.createElement("input", {
                            id: "notice-agree",
                            type: "checkbox",
                            className: "h-4 w-4 text-blue-600 bg-gray-700 border-gray-600 rounded focus:ring-blue-500",
                            checked: noticeAgreed,
                            onChange: (e) => setNoticeAgreed(e.target.checked)
                        }),
                        React.createElement("label", {
                            htmlFor: "notice-agree",
                            className: "ml-2 block text-sm text-gray-300"
                        }, "공지 내용을 확인했으며, 이에 동의합니다.")
                    )
                ),
                React.createElement("div", {
                    className: "bg-gray-800 p-6 rounded-lg shadow-lg space-y-6"
                },
                    React.createElement("div", null,
                        React.createElement("h3", {
                            className: "text-lg font-medium text-white mb-2"
                        }, "1. 사용자 정보"),
                        React.createElement("div", {
                            className: "space-y-4"
                        },
                            React.createElement("input", {
                                type: "text",
                                className: "w-full bg-gray-700 border border-gray-600 rounded-md shadow-sm py-2 px-3 text-white focus:outline-none focus:ring-blue-500 focus:border-blue-500",
                                placeholder: "부서 (e.g., 세무팀) - 필수",
                                value: department,
                                onChange: (e) => setDepartment(e.target.value),
                                required: true
                            }),
                            React.createElement("div", {
                                className: "grid grid-cols-2 gap-4"
                            },
                                React.createElement("input", {
                                    type: "text",
                                    className: "w-full bg-gray-700 border border-gray-600 rounded-md shadow-sm py-2 px-3 text-white focus:outline-none focus:ring-blue-500 focus:border-blue-500",
                                    placeholder: "성명 (e.g., 홍길동) - 필수",
                                    value: name,
                                    onChange: (e) => setName(e.target.value),
                                    required: true
                                }),
                                React.createElement("input", {
                                    type: "text",
                                    className: "w-full bg-gray-700 border border-gray-600 rounded-md shadow-sm py-2 px-3 text-white focus:outline-none focus:ring-blue-500 focus:border-blue-500",
                                    placeholder: "직위 (e.g., 선임) - 선택",
                                    value: position,
                                    onChange: (e) => setPosition(e.target.value)
                                })
                            )
                        )
                    ),
                    React.createElement("div", {
                        className: "grid grid-cols-1 md:grid-cols-[minmax(0,1fr)_auto_minmax(0,1fr)] items-start gap-4 md:gap-6 pt-6 border-t border-gray-700"
                    },
                        React.createElement("div", {
                            className: "w-full space-y-2"
                        },
                            React.createElement("div", null,
                                React.createElement("label", {
                                    htmlFor: "source-path",
                                    className: "block text-lg font-medium text-white"
                                }, `2. 원본폴더 (${sourcePaths.length}개)`)
                            ),
                            React.createElement("div", {
                                className: "flex items-center gap-2"
                            },
                                React.createElement("input", {
                                    id: "source-path",
                                    type: "text",
                                    className: "flex-grow bg-gray-700 border border-gray-600 rounded-md py-2 px-3 text-white focus:outline-none focus:ring-blue-500 focus:border-blue-500 font-mono",
                                    placeholder: "C:\\",
                                    value: currentSourcePath,
                                    onChange: (e) => setCurrentSourcePath(e.target.value),
                                    onKeyDown: (e) => e.key === 'Enter' && handleAddSourcePath()
                                }),
                                React.createElement("button", {
                                    onClick: handleAddSourcePath,
                                    className: "btn bg-gray-600 hover:bg-gray-700 focus:ring-gray-500 text-sm px-4 py-2"
                                }, "(추가)")
                            ),
                            React.createElement("div", {
                                className: "space-y-2 h-[140px] overflow-y-auto p-2 border border-gray-600 bg-gray-700 rounded-md"
                            },
                                sourcePaths.length > 0 ? sourcePaths.map((path, index) =>
                                    React.createElement("div", {
                                        key: index,
                                        className: "flex items-center justify-between bg-gray-600 p-2 rounded-md"
                                    },
                                        React.createElement("span", {
                                            className: "truncate text-sm font-mono"
                                        }, path),
                                        React.createElement("button", {
                                            onClick: () => handleRemoveSourcePath(path),
                                            className: "text-red-400 hover:text-red-300 flex-shrink-0 ml-2"
                                        }, React.createElement(XIcon, {
                                            className: "w-5 h-5"
                                        }))
                                    )
                                ) : React.createElement("div", {
                                    className: "flex items-start justify-center h-full pt-1"
                                }, React.createElement("p", {
                                    className: "text-center text-gray-500 text-sm"
                                }, "복사할 원본 폴더 경로를 입력 후 추가하세요."))
                            )
                        ),
                        React.createElement("div", {
                            className: "text-gray-500 shrink-0 mt-10"
                        },
                            React.createElement(ArrowRightIcon, {
                                className: "w-8 h-8 mx-auto hidden md:block"
                            }),
                            React.createElement(ArrowDownIcon, {
                                className: "w-8 h-8 mx-auto md:hidden"
                            })
                        ),
                        React.createElement("div", {
                            className: "w-full space-y-4 flex flex-col h-full"
                        },
                            React.createElement("div", null,
                                React.createElement("label", {
                                    htmlFor: "target-path",
                                    className: "block text-lg font-medium text-white mb-2"
                                }, "3. 대상폴더"),
                                React.createElement("input", {
                                    id: "target-path",
                                    type: "text",
                                    className: "w-full bg-gray-700 border border-gray-600 rounded-md py-2 px-3 text-white focus:outline-none focus:ring-blue-500 focus:border-blue-500 font-mono",
                                    placeholder: "D:\\백업",
                                    value: targetPath,
                                    onChange: (e) => setTargetPath(e.target.value),
                                    onBlur: (e) => setTargetPath(sanitizePath(e.target.value))
                                })
                            ),
                            fullPathDisplay && React.createElement("div", {
                                className: "text-xs text-gray-400 break-all p-3 bg-gray-900 rounded-md space-y-1"
                            },
                                React.createElement("p", null,
                                    React.createElement("span", {
                                        className: "font-semibold text-gray-300"
                                    }, "저장경로: "),
                                    React.createElement("span", {
                                        className: "font-mono text-green-400"
                                    }, fullPathDisplay)
                                ),
                                React.createElement("p", null,
                                    React.createElement("span", {
                                        className: "font-semibold text-gray-300"
                                    }, "로그 경로: "),
                                    React.createElement("span", {
                                        className: "font-mono text-cyan-400"
                                    }, logPathDisplay)
                                )
                            )
                        )
                    ),
                    React.createElement("div", {
                        className: "pt-6 border-t border-gray-700"
                    },
                        React.createElement("button", {
                            onClick: () => setIsExtensionsExpanded(!isExtensionsExpanded),
                            className: "w-full flex justify-between items-center text-lg font-medium text-white mb-2",
                            "aria-expanded": isExtensionsExpanded
                        },
                            "4. 파일 확장자",
                            React.createElement(ChevronDownIcon, {
                                className: `w-5 h-5 transition-transform ${isExtensionsExpanded ? 'rotate-180' : ''}`
                            })
                        ),
                        isExtensionsExpanded && React.createElement("div", {
                            className: "space-y-4 pt-2"
                        },
                            React.createElement("div", {
                                className: "flex gap-2"
                            },
                                React.createElement("input", {
                                    type: "text",
                                    className: "flex-grow bg-gray-700 border border-gray-600 rounded-md shadow-sm py-2 px-3 text-white focus:outline-none focus:ring-blue-500 focus:border-blue-500",
                                    placeholder: "e.g., jpg",
                                    value: currentExtension,
                                    onChange: (e) => setCurrentExtension(e.target.value),
                                    onKeyDown: (e) => e.key === 'Enter' && handleAddExtension()
                                }),
                                React.createElement("button", {
                                    onClick: handleAddExtension,
                                    className: "btn bg-gray-600 hover:bg-gray-700 focus:ring-gray-500"
                                }, "추가")
                            ),
                            React.createElement("ul", {
                                className: "grid grid-cols-3 md:grid-cols-4 lg:grid-cols-6 gap-2"
                            },
                                extensions.map(ext =>
                                    React.createElement("li", {
                                        key: ext,
                                        className: "flex items-center justify-center bg-gray-700 p-1 rounded-md text-sm group"
                                    },
                                        editingExtension?.original === ext ?
                                        React.createElement("input", {
                                            type: "text",
                                            value: editingExtension.current,
                                            onChange: (e) => setEditingExtension({ ...editingExtension, current: e.target.value }),
                                            onBlur: handleUpdateExtension,
                                            onKeyDown: (e) => e.key === 'Enter' && handleUpdateExtension(),
                                            autoFocus: true,
                                            className: "w-full bg-gray-600 text-center rounded"
                                        }) :
                                        React.createElement(React.Fragment, null,
                                            React.createElement("span", {
                                                onDoubleClick: () => handleStartEditing(ext),
                                                className: "flex-grow text-center cursor-pointer"
                                            }, `.${ext}`),
                                            React.createElement("button", {
                                                onClick: () => handleRemoveExtension(ext),
                                                className: "ml-1 text-gray-400 opacity-0 group-hover:opacity-100 transition-opacity"
                                            }, React.createElement(XIcon, {
                                                className: "w-3 h-3"
                                            }))
                                        )
                                    )
                                )
                            )
                        )
                    )
                ),
                React.createElement("div", null,
                    React.createElement("button", {
                        onClick: handleShowScriptModal,
                        disabled: !canStart,
                        className: `btn w-full text-2xl font-extrabold py-4 ${canStart ? 'bg-blue-600 hover:bg-blue-700 focus:ring-blue-500' : 'bg-gray-700 text-gray-400 cursor-not-allowed'}`
                    }, "복사하기")
                ),
                isModalOpen && generatedScript && React.createElement("div", {
                    className: "fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-50 p-4 fade-in",
                    onClick: () => setIsModalOpen(false)
                },
                    React.createElement("div", {
                        className: "bg-gray-800 rounded-lg shadow-xl w-full max-w-2xl p-6 space-y-4",
                        onClick: (e) => e.stopPropagation()
                    },
                        React.createElement("div", {
                            className: "flex justify-between items-center pb-3 border-b border-gray-700"
                        },
                            React.createElement("h3", {
                                className: "text-xl font-semibold text-white"
                            }, "생성된 Robocopy 스크립트"),
                            React.createElement("button", {
                                onClick: () => setIsModalOpen(false),
                                className: "text-gray-400 hover:text-white"
                            }, React.createElement(XIcon, {
                                className: "w-6 h-6"
                            }))
                        ),
                        React.createElement("div", {
                            className: "w-full h-48 bg-gray-900 text-gray-300 text-base p-4 rounded-md border border-gray-700 flex items-center justify-center"
                        }, React.createElement("p", {
                            className: "text-center",
                            style: { whiteSpace: 'pre-wrap' }
                        }, "스크립트가 생성되었습니다.\n아래 버튼을 사용하여 복사하거나 다운로드하세요.")),
                        React.createElement("div", {
                            className: "flex justify-end items-center gap-4 pt-4"
                        },
                            React.createElement("button", {
                                onClick: handleDownloadAndClose,
                                className: "btn bg-green-600 hover:bg-green-700 focus:ring-green-500 flex items-center gap-2"
                            },
                                React.createElement(DownloadIcon, {
                                    className: "w-5 h-5"
                                }),
                                "스크립트 다운로드 및 실행"
                            ),
                            React.createElement("button", {
                                onClick: () => setIsModalOpen(false),
                                className: "btn bg-gray-600 hover:bg-gray-700 focus:ring-gray-500"
                            }, "닫기")
                        )
                    )
                )
            );

            return React.createElement("div", {
                className: "min-h-screen bg-gray-900 text-gray-200 flex items-center justify-center p-4 fade-in"
            }, mainContent);
        };
        
        const rootElement = document.getElementById('root');
        if (!rootElement) throw new Error('Failed to find the root element');

        const root = ReactDOM.createRoot(rootElement);
        root.render(
          React.createElement(React.StrictMode, null,
            React.createElement(App, null)
          )
        );
    </script>
</body>
</html>
